{
    "version": "0.12",
    "description": "Universal script based files extractor and reimporter. Includes premade scripts from homepage",
    "homepage": "https://aluigi.altervista.org/quickbms.htm",
    "license": "GPL-2.0-only",
    "url": [
        "https://aluigi.altervista.org/papers/quickbms.zip",
        "https://aluigi.altervista.org/bms/quickbms_scripts.zip"
    ],
    "hash": [
        "B9D4F9EFB55692994CD42A491CFEA11F86E3375A618B9BD771583CE40DDB3828",
        "1DC4BB68DC330AA8623F673C5B0E326CB330696FF2B90F4719590C1BB5B304BD"
    ],
    "bin": [
        "quickbms.exe",
        "quickbms_4gb_files.exe"
    ],
    "checkver": "QuickBMS generic files extractor and reimporter ([\\d\\.]+)",
    "extract_to": [
        "",
        "scripts"
    ],
    "shortcuts": [
        [
            "quickbms.exe",
            "QuickBMS/QuickBMS",
            "-G"
        ],
        [
            "quickbms_4gb_files.exe",
            "QuickBMS/QuickBMS (4GB Files)",
            "-G"
        ]
    ],
    "post_install": [
        "Write-Host ('{0}Creating shortcut for QuickBMS/QuickBMS Scripts (scripts)' -f [char]10)",
        "$ws = New-Object -ComObject WScript.Shell",
        "$sm = [Environment]::GetFolderPath(@('Common')[!$global] + 'StartMenu')",
        "$ws = $ws.CreateShortcut($sm + '/Programs/Scoop Apps/QuickBMS/QuickBMS Scripts.lnk')",
        "$ws.TargetPath = 'explorer'",
        "$ws.Arguments = '{0}{1}{2}scripts{0}' -f [char]34, $dir, [char]92",
        "$ws.IconLocation = $dir + [char]92 + 'quickbms.exe'",
        "$ws.Save()"
    ],
    "post_uninstall": [
        "$sm = [Environment]::GetFolderPath(@('Common')[!$global] + 'StartMenu')",
        "$ln = [IO.Path]::Combine($sm, 'Programs', 'Scoop Apps', 'QuickBMS', 'QuickBMS Scripts.lnk')",
        "Write-Host ('{0}Removing shortcut {0}' -f [char]10, $ln.Replace($env:USERPROFILE, '~'))",
        "try { [IO.File]::Delete($ln) }catch{}",
        "try { [IO.Directory]::Delete($ln + '/..') }catch{}"
    ]
}
